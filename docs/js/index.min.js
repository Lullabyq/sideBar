class NavigationMenu{constructor(e){this.elem=e,this.burger=this.elem.querySelector(".burger--btn"),this.search=this.elem.querySelector(".sidebar--search"),this.widthShort=65,this.widthStandart=180,this.classes=this.elem.classList,this.fixIcon(),this.close(),window.addEventListener("resize",this.adaptSmallScreen.bind(this)),window.addEventListener("load",this.adaptSmallScreen.bind(this)),e.addEventListener("click",(e=>{if(!document.querySelector(".sidebar--active")&&e.target.closest("form")){let t=e.target.closest("form");t.classList.add("disable-transition"),this.open(),this.search.querySelector(".search__text").focus(),t.classList.remove("disable-transition")}let t=e.target.closest("button");if(!t)return;let s=t.dataset.status;s&&this[s]()})),e.addEventListener("pointerdown",(t=>{if(t.target.closest("li")){let e=t.target.closest("li"),s=e.getBoundingClientRect(),i=t.clientY,a=t.clientX,l=s.left,c=s.top,r=document.createElement("span");r.className="bubble",r.style.top=i-c+"px",r.style.left=a-l+"px",t.target.closest("li").append(r);let o=e.querySelector("A").getAttribute("href");window.location=o}let s=e.querySelector(".search__confirm");(t.target.closest("button")||t.target==s||"A"==t.target.tagName)&&t.preventDefault()})),document.addEventListener("touchstart",(e=>{let t=e.touches[0];this.swipeStart=t.clientX})),e.addEventListener("touchend",(e=>{let t=e.changedTouches[0];this.swipeEnd=t.clientX;let s=this.processSwipe();s.isLong&&s.isProper&&this[s.action]()})),document.addEventListener("pointerup",this.removeBubble.bind(this))}open(){this.classes.add("sidebar--active"),this.burger.dataset.status="close",this.adjustMain(),this.classes.contains("jsSmallScreen")&&this.classes.remove("sidebar--folded"),this.search.classList.toggle("disable-hover"),this.toggleSearch(),this.tabOptimize(),this.stopScroll()}close(){this.classes.remove("sidebar--active"),this.burger.dataset.status="open",this.adjustMain(),this.classes.contains("jsSmallScreen")&&this.classes.add("sidebar--folded"),this.search.classList.toggle("disable-hover"),this.toggleSearch(),this.tabOptimize(),this.stopScroll()}toggleSearch(){this.search.querySelectorAll("input").forEach((e=>{"submit"==e.getAttribute("type")&&(e.hidden=!e.hidden)}))}fixIcon(){let e=this.elem.querySelector(".icon--outOfFlow");e.style.left=this.widthShort/2-e.offsetWidth/2+"px"}adaptSmallScreen(){let e=this.elem.querySelectorAll(".icon--small"),t=0;this.checkSize("height",410)?e.forEach((e=>{e.classList.add("icon--"+t++)})):e.forEach((e=>{e.classList.remove("icon--"+t++)})),this.checkSize("width",690)?(this.classes.add("jsSmallScreen"),this.adjustMain(),this.classes.contains("sidebar--active")||this.classes.add("sidebar--folded")):(this.classes.remove("jsSmallScreen"),this.classes.remove("sidebar--folded"),this.adjustMain()),this.stopScroll()}removeBubble(){this.elem.querySelector(".bubble")&&this.elem.querySelector(".bubble").remove()}checkSize(e,t){switch(e){case"width":return document.documentElement.clientWidth<=t;case"height":return document.documentElement.clientHeight<=t}}adjustMain(){let e=document.querySelector("main");this.classes.contains("jsSmallScreen")?e.style.left="0px":this.classes.contains("sidebar--active")?e.style.left=this.widthStandart+"px":e.style.left=this.widthShort+"px"}tabOptimize(){let e=this.elem.querySelector(".icon--outOfFlow");this.classes.contains("sidebar--active")?e.removeAttribute("tabindex"):e.setAttribute("tabindex","2")}stopScroll(){let e=document.documentElement;this.classes.contains("jsSmallScreen")&&this.classes.contains("sidebar--active")?e.classList.add("stop__scroll"):e.classList.contains("stop__scroll")&&e.classList.remove("stop__scroll")}processSwipe(){let e={};return e.length=this.swipeEnd-this.swipeStart,e.action=this.classes.contains("sidebar--active")?"close":"open",e.length<0&&"close"==e.action||e.length>0&&"open"==e.action?e.isProper=!0:e.isProper=!1,e.isLong=Math.abs(e.length)>80,e}}let sidebar=document.querySelector(".sidebar"),menu=new NavigationMenu(sidebar);